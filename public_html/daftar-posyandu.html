<!--
Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE HTML>
<html>
<head>
    <title>Posyandu Cermat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="keywords" content="Fachrul Choliluddin"/>
    <script type="application/x-javascript"> addEventListener("load", function () {
        setTimeout(hideURLbar, 0);
    }, false);
    function hideURLbar() {
        window.scrollTo(0, 1);
    } </script>
    <link href="ui/css/bootstrap.min.css" rel='stylesheet' type='text/css'/>
    <!-- Custom Theme files -->
    <link href="ui/css/style.css" rel='stylesheet' type='text/css'/>
    <link href="ui/css/font-awesome.css" rel="stylesheet">
    <!--<script src="js/jquery.min.js"></script>-->
    <script src="ui/js/jquery-1.12.0.min.js"></script>
    <script src="ui/js/bootstrap.min.js"></script>
    <!-- Mainly scripts -->
    <script src="ui/js/jquery.metisMenu.js"></script>
    <script src="ui/js/jquery.slimscroll.min.js"></script>
    <!-- Custom and plugin javascript -->
    <link href="ui/css/custom.css" rel="stylesheet">
    <link href="ui/css/datatables.min.css" rel="stylesheet">
    <script src="ui/js/custom.js"></script>
    <script src="ui/js/screenfull.js"></script>
    <script>
        $(function () {
            $('#supported').text('Supported/allowed: ' + !!screenfull.enabled);
            if (!screenfull.enabled) {
                return false;
            }

            $('#toggle').click(function () {
                screenfull.toggle($('#container')[0]);
            });
        });
    </script>


    <style>
        .nav-second-level li {
            padding-left: 20px;
        }
    </style>
</head>
<body>
<div id="wrapper">
    <!----->
    <nav class="navbar-default navbar-static-top" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <h1><a class="navbar-brand" href="0_index.html"><span class="fa fa-child"></span> Posyandu</a></h1>
        </div>
        <div class=" border-bottom">
            <div class="full-left">
                <section class="full-top">
                    <button id="toggle"><i class="fa fa-arrows-alt"></i></button>
                </section>
                <form class=" navbar-left-right">
                    <input type="text" value="Search..." onfocus="this.value = '';" onblur="if (this.value == '') {
                                        this.value = 'Search...';
                                    }">
                    <input type="submit" value="" class="fa fa-search">
                </form>
                <div class="clearfix"></div>
            </div>


            <!-- Brand and toggle get grouped for better mobile display -->

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="drop-men">
                <ul class=" nav_1">

                    <li class="dropdown at-drop">
                        <a href="#" class="dropdown-toggle dropdown-at " data-toggle="dropdown"><i
                                class="fa fa-globe"></i> <span class="number">5</span></a>
                        <ul class="dropdown-menu menu1 " role="menu">
                            <li><a href="#">

                                <div class="user-new">
                                    <p>New user registered</p>
                                    <span>40 seconds ago</span>
                                </div>
                                <div class="user-new-left">

                                    <i class="fa fa-user-plus"></i>
                                </div>
                                <div class="clearfix"></div>
                            </a></li>
                            <li><a href="#">
                                <div class="user-new">
                                    <p>Someone special liked this</p>
                                    <span>3 minutes ago</span>
                                </div>
                                <div class="user-new-left">

                                    <i class="fa fa-heart"></i>
                                </div>
                                <div class="clearfix"></div>
                            </a></li>
                            <li><a href="#">
                                <div class="user-new">
                                    <p>John cancelled the event</p>
                                    <span>4 hours ago</span>
                                </div>
                                <div class="user-new-left">

                                    <i class="fa fa-times"></i>
                                </div>
                                <div class="clearfix"></div>
                            </a></li>
                            <li><a href="#">
                                <div class="user-new">
                                    <p>The server is status is stable</p>
                                    <span>yesterday at 08:30am</span>
                                </div>
                                <div class="user-new-left">

                                    <i class="fa fa-info"></i>
                                </div>
                                <div class="clearfix"></div>
                            </a></li>
                            <li><a href="#">
                                <div class="user-new">
                                    <p>New comments waiting approval</p>
                                    <span>Last Week</span>
                                </div>
                                <div class="user-new-left">

                                    <i class="fa fa-rss"></i>
                                </div>
                                <div class="clearfix"></div>
                            </a></li>
                            <li><a href="#" class="view">View all messages</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle dropdown-at" data-toggle="dropdown"><span
                                class=" name-caret">Rackham<i class="caret"></i></span><img src="gambar/admin/wo2.jpeg"
                                                                                            width="60"></a>
                        <ul class="dropdown-menu " role="menu">
                            <li><a href="profile.html"><i class="fa fa-user"></i>Edit Profile</a></li>
                            <li><a href="inbox.html"><i class="fa fa-envelope"></i>Inbox</a></li>
                            <li><a href="calendar.html"><i class="fa fa-calendar"></i>Calender</a></li>
                            <li><a href="inbox.html"><i class="fa fa-clipboard"></i>Tasks</a></li>
                        </ul>
                    </li>

                </ul>
            </div><!-- /.navbar-collapse -->
            <div class="clearfix">

            </div>

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">

                        <li>
                            <a href="0_index.html" class=" hvr-bounce-to-right"><i class="fa fa-home nav_icon "></i><span
                                    class="nav-label">Beranda</span> </a>
                        </li>

                        <li>
                            <a href="#" class=" hvr-bounce-to-right"><i class="fa fa-hospital-o nav_icon"></i> <span
                                    class="nav-label">Data Posyandu</span><span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li><a href="#" class=" hvr-bounce-to-right"> <i class="fa fa-clipboard nav_icon"></i>Daftar
                                    Posyandu</a></li>
                                <li><a href="#" class=" hvr-bounce-to-right"> <i class="fa fa-area-chart nav_icon"></i>Statistik</a>
                                </li>
                                <li><a href="#" class=" hvr-bounce-to-right"><i class="fa fa-map-marker nav_icon"></i>Lokasi</a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href="#" class=" hvr-bounce-to-right"><i class="fa fa-female nav_icon"></i> <span
                                    class="nav-label">Data Ibu</span><span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li><a href="#" class=" hvr-bounce-to-right"> <i class="fa fa-clipboard nav_icon"></i>Daftar
                                    Ibu</a></li>
                                <li><a href="#" class=" hvr-bounce-to-right"> <i class="fa fa-area-chart nav_icon"></i>Statistik</a>
                                </li>
                                <li><a href="#" class=" hvr-bounce-to-right"><i class="fa fa-heart nav_icon"></i>Kehamilan</a>
                                </li>
                                <li><a href="#" class=" hvr-bounce-to-right"><i class="fa fa-ambulance nav_icon"></i>Kematian</a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href="#" class=" hvr-bounce-to-right"><i class="fa fa-check-circle-o nav_icon"></i> <span
                                    class="nav-label">Layanan Ibu</span><span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li><a href="#" class=" hvr-bounce-to-right"> <i class="fa fa-heart nav_icon"></i>Ibu
                                    hamil</a></li>
                                <li><a href="#" class=" hvr-bounce-to-right"> <i class="fa fa-eyedropper nav_icon"></i>Imunisasi
                                    TT</a></li>
                                <li><a href="#" class=" hvr-bounce-to-right"><i class="fa fa-group nav_icon"></i>Keluarga
                                    berencana</a></li>
                                <li><a href="#" class=" hvr-bounce-to-right"><i class="fa fa-arrows-alt nav_icon"></i>Pengukuran
                                    LILA</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#" class=" hvr-bounce-to-right"><i class="fa fa-child nav_icon"></i> <span
                                    class="nav-label">Data Anak</span><span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li><a href="profil-anak.html" class=" hvr-bounce-to-right"> <i
                                        class="fa fa-clipboard nav_icon"></i>Daftar
                                    Anak</a></li>
                                <li><a href="profil-anak.html" class=" hvr-bounce-to-right"> <i
                                        class="fa fa-area-chart nav_icon"></i>Statistik</a>
                                </li>
                                <li><a href="profil-anak.html" class=" hvr-bounce-to-right"><i
                                        class="fa fa-ambulance nav_icon"></i>Kematian</a>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href="#" class=" hvr-bounce-to-right"><i class="fa fa-check-circle-o nav_icon"></i> <span
                                    class="nav-label">Layanan Anak</span><span class="fa arrow"></span></a>
                            <ul class="nav nav-second-level">
                                <li><a href="#" class=" hvr-bounce-to-right"> <i class="fa fa-dashboard nav_icon"></i>Pengukuran
                                    anak</a></li>
                                <li><a href="#" class=" hvr-bounce-to-right"> <i class="fa fa-eyedropper nav_icon"></i>Imunisasi</a>
                                </li>
                                <li><a href="#" class=" hvr-bounce-to-right"><i class="fa fa-male nav_icon"></i>Status
                                    gizi</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="layout.html" class=" hvr-bounce-to-right"><i
                                    class="fa fa-file-text-o nav_icon"></i> <span class="nav-label">Laporan</span> </a>
                        </li>
                        <li>
                            <a href="layout.html" class=" hvr-bounce-to-right"><i
                                    class="fa fa-institution nav_icon"></i> <span class="nav-label">Petugas</span> </a>
                        </li>
                        <li>
                            <a href="layout.html" class=" hvr-bounce-to-right"><i class="fa fa-sign-out nav_icon"></i>
                                <span class="nav-label">Keluar</span> </a>
                        </li>

                    </ul>
                </div>
            </div>
    </nav>
    <div id="page-wrapper" class="gray-bg dashbard-1">
        <div class="content-main">

            <!--banner-->
            <div class="banner">
                <h2>
                    <a href="0_index.html">Home</a>
                    <i class="fa fa-angle-right"></i>
                    <span>Daftar Posyandu</span>
                    <i class="fa fa-angle-right"></i>
                    <span>Kecamatan Meruya</span>
                </h2>
            </div>
            <!--//banner-->
            <!--isi-->
            <div class="content-top">
                <div class="col-md-12">
                    <div id="peta-utama" style="height: 15em">

                    </div>
                </div>
                <div class="clearfix"></div>
            </div>
            <div class="fch-isi">
                <div class="fch-isi-nya">
                    <div class="col-md-5">
                        <button type="button" class="btn btn-success" id="btn-tambah">
                            <span class="fa fa-plus-circle"></span> Tambah
                        </button>
                        <span id="row-selected" style="display: none;">
                            <button type="button" class="btn btn-warning" id="btn-ubah">
                                <span class="fa fa-pencil"></span> Ubah
                            </button>
                            <button type="button" class="btn btn-danger" id="btn-hapus">
                                <span class="fa fa-trash"></span> Hapus
                            </button>
                        </span>
                    </div>
                    <div class="col-md-7">
                        <h5>Daftar Posyandu</h5>
                    </div>
                    <div class="clearfix"></div>
                    <div class="col-md-12 ">
                        <table id="table-posyandu" class="table table-bordered table-striped">
                            <thead>
                            <tr>
                                <th>Kode</th>
                                <th style="width: 150px">Nama Posyandu</th>
                                <th>Alamat</th>
                                <th style="width: 42px">Peta</th>
                                <th style="width: 100px">Jumlah Kader</th>
                                <th>Status</th>
                            </tr>
                            </thead>
                            <tfoot>
                            <tr>
                                <th>Kode</th>
                                <th style="width: 150px">Nama Posyandu</th>
                                <th>Alamat</th>
                                <th style="width: 42px">Peta</th>
                                <th style="width: 100px">Jumlah Kader</th>
                                <th>Status</th>
                            </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>

                <div class="clearfix"></div>
            </div>

            <div class="content-bottom">
                bawah
                <div class="clearfix"></div>
            </div>

            <!--//faq-->
            <!---->
            <div class="copy">
                <p> &copy; 2016 Minimal. All Rights Reserved | Design by <a href="http://w3layouts.com/"
                                                                            target="_blank">W3layouts</a></p></div>
        </div>
    </div>
    <div class="clearfix"></div>
</div>

<div class="modal fade" id="mdl-tambah" tabindex="-1" role="dialog" aria-labelledby="mdl-tambah" aria-hidden="true"
     style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h2 class="modal-title">Tambah Posyandu baru</h2>
            </div>
            <div class="modal-body">
                <form action="#" id="form-posyandu" method="post">
                    <div class="form-group">
                        <label for="id_posyandu">ID Posyandu</label>
                        <input type="text" class="form-control" id="id_posyandu"
                               placeholder="ID Posyandu akan di generate sisitem" disabled>
                    </div>
                    <div class="form-group">
                        <label for="nama">Nama Posyandu</label>
                        <input type="text" class="form-control" id="nama" placeholder="Nama Posyandu"
                               required="required">
                    </div>
                    <div class="form-group">
                        <label for="aktif">Status Posyandu</label>
                        <div class="radio">
                            <label>
                                <input type="radio" name="aktif" id="aktif" value="A" required="required">
                                Aktif
                            </label>
                        </div>
                        <div class="radio">
                            <label>
                                <input type="radio" name="aktif" id="tdk-aktif" value="B">
                                Tidak aktif
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="prov">Provinsi</label>
                        <select class="form-control" name="prov" id="prov" required="required">
                            <option value="0">-Pilih Provinsi-</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="prov">Kota/Kab</label>
                        <select class="form-control" name="kab" id="kab" disabled required="required">
                            <option value="0">-Pilih Kota/Kab-</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="prov">Kecamatan</label>
                        <select class="form-control" name="kec" id="kec" disabled required="required">
                            <option value="0">-Pilih Kecamatan-</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="prov">Kelurahan</label>
                        <select class="form-control" name="kel" id="kel" disabled required="required">
                            <option value="0">-Pilih Kelurahan-</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="alamat">Alamat Posyandu</label>
                        <input type="text" class="form-control" id="alamat" placeholder="Masukan alamat"
                               required="required">
                    </div>
                    <div class="form-group">
                        <label for="peta">Peta Posyandu</label>
                        <div style="height: 400px;" id="peta"></div>
                    </div>
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-succes"
                            data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Mohon tunggu" id="btn-submit">Submit
                    </button>
                </form>
            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div>

<!--scrolling js-->
<script src="ui/js/jquery.nicescroll.js" type="text/javascript"></script>
<script src="ui/js/localforage.min.js" type="text/javascript"></script>
<script src="ui/js/scripts.js" type="text/javascript"></script>
<!--//scrolling js-->
<script src="ui/js/datatables.min.js" type="text/javascript"></script>
<!-- <script src='http://maps.google.com/maps/api/js?libraries=places' type="text/javascript"></script>
<script src='ui/js/locationpicker.jquery.min.js' type="text/javascript"></script> -->
<style>
    table.dataTable tbody tr.selected {
        /*buat selected element datatable*/
        background-color: rgb(164, 236, 164);
    }

    .pac-container {
        /*buat autocomplete locationpicker*/
        z-index: 2000 !important;
    }
</style>
<script type="text/javascript">
    $user = {posisi: {}};

    function getLokasi() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) { // on success
                $user.posisi.latitude = position.coords.latitude;
                $user.posisi.longitude = position.coords.longitude;
            }, function (error) { // on error
                console.log('code: ' + error.code + '\n' +
                        'message: ' + error.message + '\n');

                // set lokasi default
                $user.posisi = {
                    "latitude": -6.2036776,
                    "longitude": 106.8214523
                };
            });
        } else {
            console.log("Geolocation is not supported.");
        }
    }

    $(document).ready(function () {
        window.peta = null;
        getLokasi();
        // getProvinsi();
        // ambil data posyandu
        $.getJSON('api/posyandu.json', function (result) {
            //console.log(result.response_data);
            inisiasi(result.response_data);

        });

        function inisiasi(data) {
            window.peta = data;
            LoadMap();
            var table = $("#table-posyandu").DataTable({
                data: data,
                columns: [
                    {data: 'kode'},
                    {data: 'nama'},
                    {data: 'alamat'},
                    {
                        data: 'koordinat.lat', render: function () {
                        return 'Peta';
                    }
                    },
                    {data: 'kader_jum'},
                    {
                        data: 'status', render: function (data) {
                        if (data == 1) {
                            return 'Aktif';
                        } else {
                            return 'Non Aktif';
                        }
                    }
                    }
                ]
            });

            $('#table-posyandu tbody').on('click', 'tr', function () {
                window.dataKlik = table.row(this).data();

                if ($(this).hasClass('selected')) {
                    $(this).removeClass('selected');
                    $('#row-selected').fadeOut('slow');
                }
                else {
                    table.$('tr.selected').removeClass('selected');
                    $(this).addClass('selected');
                    $('#row-selected').fadeIn('slow');
                }
            });
        }


        // bikin peta sekitar
        function LoadMap() {
            // var mapOptions = {
            //     center: new google.maps.LatLng(window.peta[0].koordinat.lat, window.peta[0].koordinat.lng),
            //     zoom: 14,
            //     mapTypeId: google.maps.MapTypeId.ROADMAP
            // };
            // var map = new google.maps.Map(document.getElementById("peta-utama"), mapOptions);

            // //Create and open InfoWindow.
            // var infoWindow = new google.maps.InfoWindow();

            // for (var i = 0; i < window.peta.length; i++) {
            //     var data = window.peta[i];
            //     var myLatlng = new google.maps.LatLng(data.koordinat.lat, data.koordinat.lng);
            //     var marker = new google.maps.Marker({
            //         position: myLatlng,
            //         map: map,
            //         title: data.title
            //     });

            //     //Attach click event to the marker.
            //     (function (marker, data) {
            //         google.maps.event.addListener(marker, "click", function (e) {
            //             //Wrap the content inside an HTML DIV in order to set height and width of InfoWindow.
            //             infoWindow.setContent("<div style = 'width:25em;min-height:40px'><b>" + data.nama + "</b><p>" + data.alamat + "</p></div>");
            //             infoWindow.open(map, marker);
            //         });
            //     })(marker, data);
            // }
        }
    });

    function input_form(data) {
        if (data.length == 0) {
            $('#form-posyandu')[0].reset();
        } else {
            $('#id_posyandu').val(data.kode);
            $('#nama').val(data.nama);
            $('#kader').val(data.kader_jum);
            $('#aktif').val(data.status);
            $('#alamat').val(data.alamat);
        }
        setTimeout(function () {
            $('#mdl-tambah').modal('show');
        }, 100);
    }

    $('#btn-tambah').on('click', function () {
        input_form({});
    });

    var stillPresent = false;

    // ====================== EVENT ======================
    $('#mdl-tambah').on('shown.bs.modal', function (e) {
        //masukan data provinsi
        $.each(dataProvinsi, function (idx, val) {
            $('#prov').append('<option value="' + val.id_prov + '">' + val.nama_prov + '</option>');
        });

        if (stillPresent == false) {

            $('#peta').locationpicker({
                location: $user.posisi,
                radius: 0,
                zoom: 15,
                enableAutocomplete: true,
                inputBinding: {
                    locationNameInput: $('#alamat')
                },
                onchanged: function (currentLocation, radius, isMarkerDropped) {
                    console.log("Location changed. New location (" + currentLocation.latitude + ", " + currentLocation.longitude + ")");
                    $user.posisi = {
                        latitude: currentLocation.latitude,
                        longitude: currentLocation.longitude
                    }
                }
            });
            stillPresent = true;
        }
    });


    $(document).on('click', '#btn-ubah', function () {
        input_form(window.dataKlik);
    });

    $('#prov').on('change', function () {
        $('#kab').removeAttr("disabled");
        $('#kec').html('<option value="0">-Pilih Kecamatan-</option>').prop("disabled", true);
        $('#kel').html('<option value="0">-Pilih Kelurahan-</option>').prop("disabled", true);
        var id_prov = this.selectedOptions[0].value;
        var selectedText = this.selectedOptions[0].text;
        getKab(id_prov);
    });

    $('#kab').on('change', function () {
        var id_kab = this.selectedOptions[0].value;
        $('#kec').removeAttr("disabled");
        getKec(id_kab);
    });

    $('#kec').on('change', function () {
        var id_kec = this.selectedOptions[0].value;
        $('#kel').removeAttr("disabled");
        getKel(id_kec);
    });

    $('#form-posyandu').on('submit', function (e) {
        e.preventDefault();
        var $this = $(this);
        $('#btn-submit').button('loading');
        setTimeout(function () {
            $('#btn-submit').button('reset');
        }, 3000);
    })
</script>
</body>
</html>
